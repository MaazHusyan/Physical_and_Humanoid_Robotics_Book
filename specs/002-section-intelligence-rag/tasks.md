# Tasks: Section 2 - Intelligence Layer (RAG & Agent Skills)

**Input**: Design documents from `/specs/002-section-intelligence-rag/`
**Prerequisites**: plan.md (required), spec.md (required for user stories), research.md, data-model.md

## Phase 1: Setup (Shared Infrastructure)

**Purpose**: Project initialization and basic structure

- [x] T001 Initialize backend dependencies with `uv add openai-agents jina qdrant-client` in `server/`
- [x] T002 [P] Create `.env` template in `server/.env.example` with GEMINI_API_KEY, JINA_API_KEY, QDRANT_URL, QDRANT_API_KEY
- [x] T003 Configure environment loading in `server/app/core/config.py`

## Phase 2: Foundational (Blocking Prerequisites)

**Purpose**: Core infrastructure that MUST be complete before ANY user story can be implemented

- [x] T004 Setup Qdrant collection initialization logic in `server/app/services/vector_db.py`
- [x] T005 [P] Implement Jina AI embedding client in `server/app/services/embedding.py`
- [x] T006 [P] Implement Gemini/Agent SDK wrapper in `server/app/services/ai_service.py`
- [x] T007 Define Pydantic models for KnowledgeChunk and ChatSession in `server/app/models/chat.py`
- [x] T008 [P] Setup basic FastAPI routing in `server/main.py` and mount v1 routers

## Phase 3: User Story 1 - Interactive Robotics Tutor (Priority: P1) ðŸŽ¯ MVP

**Goal**: Enable students to ask questions about robotics content.

**Independent Test**: Query `/api/v1/chat` with a known topic (e.g., "Jacobian") and receive a RAG-enriched response.

- [x] T009 [US1] Implement RAG retrieval logic in `server/app/services/vector_db.py` (search by similarity with filtering)
- [x] T010 [US1] Create chat router with streaming response endpoint in `server/app/api/v1/chat.py`
- [x] T011 [US1] Integrate Gemini reasoning with retrieved context in `server/app/services/ai_service.py`
- [x] T012 [US1] Add robust error handling for API outages in `server/app/services/ai_service.py`

## Phase 4: User Story 2 - Automated Knowledge Indexing (Priority: P2)

**Goal**: Automatically index markdown chapters into the vector database.

**Independent Test**: Place a new `.md` file in `content/docs/`, trigger indexing, and verify its presence in Qdrant.

- [x] T013 [US2] Implement markdown splitting logic in `server/app/services/markdown_parser.py`
- [x] T014 [US2] Create indexing router and endpoint in `server/app/api/v1/index.py`
- [x] T015 [US2] Implement recursive folder indexing logic in `server/app/services/vector_db.py`
- [x] T016 [US2] Add filesystem watch or trigger command for manual indexing.

## Phase 5: Polish & Cross-Cutting Concerns

**Purpose**: Improvements that affect multiple user stories

- [x] T017 Update Docusaurus `sidebars.js` to use `autogenerated` tag for docs folder.
- [x] T018 Integrate chatbot UI component (or simple proxy) in Docusaurus frontend.
- [x] T019 [P] Run final validation against `quickstart.md`.
- [x] T020 [P] Final cross-artifact analysis via `/sp.analyze`.

## Dependencies & Execution Order

### Phase Dependencies
- **Setup (Phase 1)**: No dependencies.
- **Foundational (Phase 2)**: Depends on Setup (T001-T003).
- **User Story 1 (Phase 3)**: Depends on Foundational (T004-T008).
- **User Story 2 (Phase 4)**: Depends on Foundational.
- **Polish (Final Phase)**: Depends on Phase 3 and 4.

---
ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
